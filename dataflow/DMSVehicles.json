{
	"name": "DMSVehicles",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DMSVehiclesCSV",
						"type": "DatasetReference"
					},
					"name": "DMSVehiclesCSV"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SQLDMSVehicle_Merge",
						"type": "DatasetReference"
					},
					"name": "SQLDMSVehiclesMerge"
				}
			],
			"transformations": [],
			"script": "source(output(\n\t\t{Client ID} as integer,\n\t\t{Vehicle ID} as string,\n\t\t{Vehicle Type} as string,\n\t\tMake as string,\n\t\tModel as string,\n\t\tDerative as string,\n\t\t{Registration Number} as string,\n\t\t{Registration Date} as date,\n\t\t{Delivery Date} as date,\n\t\t{New or Used} as string,\n\t\t{Last ServiceDate} as date,\n\t\t{Next Service Date} as date,\n\t\t{Last MOT Date} as date,\n\t\t{Next MOT Date} as date,\n\t\t{Last Workshop Date} as date,\n\t\t{Chassis Number} as string,\n\t\t{Customer ID} as string,\n\t\tStatus as string,\n\t\tTrim as string,\n\t\t{Engine Size} as integer,\n\t\tBodystyle as string,\n\t\tOdometer as string,\n\t\t{Odometer Type} as string,\n\t\tFuelType as string,\n\t\tTransmission as string,\n\t\t{Generic Colour} as string,\n\t\t{Specific Colour} as string,\n\t\tDoors as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\trowUrlColumn: 'FileName',\n\twildcardPaths:['Client Folder/*/DMSVehicles-*.csv']) ~> DMSVehiclesCSV\nDMSVehiclesCSV sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tClientID as integer,\n\t\tVehicleID as integer,\n\t\tMake as string,\n\t\tModel as string,\n\t\tDerivative as string,\n\t\tRegistrationNumber as string,\n\t\tDateofRegistration as date,\n\t\tDeliveryDate as date,\n\t\tNewOrUsed as string,\n\t\tLastServiceDate as string,\n\t\tNextServiceDate as string,\n\t\tLastMOTDate as string,\n\t\tNextMOTDate as string,\n\t\tLastWorkshopDate as string,\n\t\tCapCode as string,\n\t\tChassisNumber as string,\n\t\tDriverCustomerID as integer,\n\t\tAftersalesCustomerID as integer,\n\t\tSalesCustomerID as integer,\n\t\tRecordStatus as string,\n\t\tVehicleType as string,\n\t\tTrim as string,\n\t\tEngineSize as integer,\n\t\tBodystyle as string,\n\t\tOdometer as integer,\n\t\tOdometerType as string,\n\t\tFuelType as string,\n\t\tTransmission as string,\n\t\tGenericColour as string,\n\t\tSpecificColour as string,\n\t\tDoors as integer,\n\t\tFileName as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tClientID = {Client ID},\n\t\tVehicleID = {Vehicle ID},\n\t\tMake,\n\t\tModel,\n\t\tDerivative = Derative,\n\t\tRegistrationNumber = {Registration Number},\n\t\tDateofRegistration = {Registration Date},\n\t\tDeliveryDate = {Delivery Date},\n\t\tNewOrUsed = {New or Used},\n\t\tLastServiceDate = {Last ServiceDate},\n\t\tNextServiceDate = {Next Service Date},\n\t\tLastMOTDate = {Last MOT Date},\n\t\tNextMOTDate = {Next MOT Date},\n\t\tLastWorkshopDate = {Last Workshop Date},\n\t\tChassisNumber = {Chassis Number},\n\t\tDriverCustomerID = {Customer ID},\n\t\tRecordStatus = Status,\n\t\tVehicleType = {Vehicle Type},\n\t\tTrim,\n\t\tEngineSize = {Engine Size},\n\t\tBodystyle,\n\t\tOdometer,\n\t\tOdometerType = {Odometer Type},\n\t\tFuelType,\n\t\tTransmission,\n\t\tGenericColour = {Generic Colour},\n\t\tSpecificColour = {Specific Colour},\n\t\tDoors,\n\t\tFileName\n\t)) ~> SQLDMSVehiclesMerge"
		}
	}
}