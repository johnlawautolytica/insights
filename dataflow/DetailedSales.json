{
	"name": "DetailedSales",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DetailedSalesCSV",
						"type": "DatasetReference"
					},
					"name": "DetailedSales"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SQLDMSVehicleSales",
						"type": "DatasetReference"
					},
					"name": "SQLDMSDetailedSales"
				}
			],
			"transformations": [],
			"script": "source(output(\n\t\t{Client ID} as integer,\n\t\t{Dealer ID} as string,\n\t\t{Customer ID} as string,\n\t\t{New or Used} as string,\n\t\t{Vehicle Type} as string,\n\t\t{Vehicle ID} as string,\n\t\t{Stock Number} as string,\n\t\t{Registration Number} as string,\n\t\t{Registration Date} as date,\n\t\t{Dealership Date in Stock} as date,\n\t\tMileage as integer,\n\t\t{Stock Value} as decimal(10,0),\n\t\t{Sale Date} as date,\n\t\t{Invoice Number} as string,\n\t\t{Sales Executive ID} as string,\n\t\t{Full Invoice Value} as decimal(10,0),\n\t\t{Paint Value} as decimal(10,0),\n\t\t{Warranty Value} as decimal(10,0),\n\t\t{GAP Value} as decimal(10,0),\n\t\t{Wheel Protection Value} as decimal(10,0),\n\t\t{Add on Product 1} as string,\n\t\t{Add on Product 2} as string,\n\t\t{Add on Product 3} as string,\n\t\t{Add on Product 4} as string,\n\t\t{Accessory Value} as decimal(10,0),\n\t\tReconditioning as decimal(10,0),\n\t\t{Finance Commission} as decimal(10,0),\n\t\tFinanced as string,\n\t\t{Total Gross Profit} as decimal(10,0),\n\t\t{Sale Type} as string,\n\t\t{Part Exchange Stock Number 1} as string,\n\t\t{Part Exchange Stock Number 2} as string,\n\t\t{Part Exchange Stock Number 3} as string,\n\t\tSource as string,\n\t\t{Vehicle Category Code} as string,\n\t\t{Purchaser ID} as string,\n\t\tSupplier as string,\n\t\t{Available Date} as date,\n\t\t{Accessory Profit} as decimal(10,0),\n\t\t{Paint Profit} as decimal(10,0),\n\t\t{Warranty Profit} as decimal(10,0),\n\t\t{GAP Profit} as decimal(10,0),\n\t\t{Other Profit} as decimal(10,0),\n\t\t{Add On Product 1 Profit} as decimal(10,0),\n\t\t{Add On Product 2 Profit} as decimal(10,0),\n\t\t{Add On Product 3 Profit} as decimal(10,0),\n\t\t{Add On Product 4 Profit} as decimal(10,0),\n\t\t{Volume Bonus} as decimal(10,0),\n\t\t{Other Bonus} as decimal(10,0),\n\t\t{RFL Profit} as decimal(10,0),\n\t\t{Metal Profit} as decimal(10,0),\n\t\t{Metal Invoice Value} as decimal(10,0),\n\t\t{Delivery Date} as date,\n\t\t{Group Purchase Date} as date,\n\t\t{Received Date} as date,\n\t\t{Purchase Account} as string,\n\t\t{Sales Account ID} as string,\n\t\t{Sales Account Name} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tdateFormats: ['dd/MM/yyyy'],\n\twildcardPaths:['DetailedVehSales*.csv']) ~> DetailedSales\nDetailedSales sink(allowSchemaDrift: false,\n\tvalidateSchema: false,\n\tinput(\n\t\tClientID as integer,\n\t\tDealer as string,\n\t\tCustId as string,\n\t\tTitle as string,\n\t\tForename as string,\n\t\tSurname as string,\n\t\tEmail as string,\n\t\tHomePhone as string,\n\t\tMobile as string,\n\t\tAdd1 as string,\n\t\tAdd2 as string,\n\t\tAdd3 as string,\n\t\tAdd4 as string,\n\t\tPostcode as string,\n\t\tNewOrUsed as string,\n\t\tType as string,\n\t\tVehMagic as string,\n\t\tStockNo as string,\n\t\tChassis as string,\n\t\tRegistrationNo as string,\n\t\tRegistrationDate as date,\n\t\tDateInStock as date,\n\t\tCapVin as string,\n\t\tCapCode as string,\n\t\tMake as string,\n\t\tModel as string,\n\t\tDerivative as string,\n\t\tEngineSize as string,\n\t\tBodystyle as string,\n\t\tMileage as integer,\n\t\tFuel as string,\n\t\tTransmission as string,\n\t\tGenericColour as string,\n\t\tSpecificColour as string,\n\t\tDoors as string,\n\t\tSiv as double,\n\t\tSaleDate as date,\n\t\tInvNumber as integer,\n\t\tSalesExec as string,\n\t\tFullInvValue as double,\n\t\tPaint as double,\n\t\tWarr as double,\n\t\tGap as double,\n\t\tAcc as double,\n\t\tRecon as double,\n\t\tFinanceCommission as double,\n\t\tProfit as double,\n\t\tSaleType as string,\n\t\tPx1 as string,\n\t\tPx2 as string,\n\t\tPx3 as string,\n\t\tSource as string,\n\t\tModelAnalysisCode as string,\n\t\tPurchaser as string,\n\t\tSupplierName as string,\n\t\tPurchaseInvoiceDate as date,\n\t\tAvailableDate as date,\n\t\tAccessoryProfit as double,\n\t\tPaintProfit as double,\n\t\tWarrProfit as double,\n\t\tGapProfit as double,\n\t\tOtherProfit as double,\n\t\tVolumeBonus as double,\n\t\tBonus as double,\n\t\tRflProfit as double,\n\t\tMetalProfit as double,\n\t\tVehicleInvoiceValue as double,\n\t\tDeliveryDate as date,\n\t\tGroupPurchaseDate as date,\n\t\tReceivedDate as date,\n\t\tDateInGroup as date,\n\t\tPurchaseAccount as string,\n\t\tFuelTypeID as string,\n\t\tSalesAccountID as string,\n\t\tSalesAccountName as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tpreSQLs:['truncate table dbo.DMSVehicleSales'],\n\tpostSQLs:['update dbo.DMSVehicleSales set ClientID = 10000 where ClientID is null'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'allErrors',\n\ttransactionCommit: 'single',\n\treportSuccessOnError: false,\n\tmapColumn(\n\t\tDealer,\n\t\tCustId = {Cust ID},\n\t\tTitle,\n\t\tForename = forename,\n\t\tSurname,\n\t\tEmail = email,\n\t\tHomePhone = {home phone},\n\t\tMobile = mobile,\n\t\tAdd1 = {add 1},\n\t\tAdd2 = {add 2},\n\t\tAdd3 = {add 3},\n\t\tAdd4 = {add 4},\n\t\tPostcode = postcode,\n\t\tNewOrUsed = {New or Used},\n\t\tType = type,\n\t\tVehMagic = {Veh Magic},\n\t\tStockNo = {stock no},\n\t\tChassis = chassis,\n\t\tRegistrationNo = {reg no},\n\t\tRegistrationDate = {reg date},\n\t\tDateInStock = {date in stock},\n\t\tCapVin = {CAP VIN},\n\t\tCapCode = {CAP code},\n\t\tMake = make,\n\t\tModel = model,\n\t\tDerivative = derivative,\n\t\tEngineSize = {engine size},\n\t\tBodystyle = bodystyle,\n\t\tMileage = mileage,\n\t\tFuel = fuel,\n\t\tTransmission = transmission,\n\t\tGenericColour = {generic colour},\n\t\tSpecificColour = {specific colour},\n\t\tDoors = doors,\n\t\tSiv = SIV,\n\t\tSaleDate = {sale date},\n\t\tInvNumber = {inv number},\n\t\tSalesExec = {sales exec},\n\t\tFullInvValue = {full inv value},\n\t\tPaint = paint,\n\t\tWarr = warr,\n\t\tGap = GAP,\n\t\tAcc,\n\t\tRecon = recon,\n\t\tFinanceCommission = {Finance commission},\n\t\tProfit = profit,\n\t\tSaleType = {Sale type},\n\t\tPx1 = PX1,\n\t\tPx2 = PX2,\n\t\tPx3 = PX3,\n\t\tSource,\n\t\tModelAnalysisCode = {Model Analysis Code},\n\t\tPurchaser,\n\t\tPurchaseInvoiceDate = {Purchase Invoice Date},\n\t\tAvailableDate = {Available Date},\n\t\tAccessoryProfit = {Accessory Profit},\n\t\tPaintProfit = {Paint Profit},\n\t\tWarrProfit = {Warr Profit},\n\t\tGapProfit = {Gap Profit},\n\t\tOtherProfit = {Other Profit},\n\t\tVolumeBonus = {Volume Bonus},\n\t\tBonus,\n\t\tRflProfit = {RFL Profit},\n\t\tMetalProfit = {Metal Profit},\n\t\tVehicleInvoiceValue = {Vehicle Invoice Value},\n\t\tDeliveryDate = {Delivery Date},\n\t\tGroupPurchaseDate = {Group Purchase Date},\n\t\tReceivedDate = {Received Date},\n\t\tDateInGroup = {Date In Group},\n\t\tPurchaseAccount = {Purchase Account},\n\t\tFuelTypeID = {Fuel Type},\n\t\tSalesAccountID = {Sales Account ID},\n\t\tSalesAccountName = {Sales Account Name}\n\t)) ~> SQLDMSDetailedSales"
		}
	}
}