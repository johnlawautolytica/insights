{
	"name": "PeterVardyEnquiryMAX",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "PeterVardyEnquiryMaxCSV",
						"type": "DatasetReference"
					},
					"name": "PeterVardyEnquiryMAX"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SQLEnquiryMax",
						"type": "DatasetReference"
					},
					"name": "SQLPeterVardyEnquiryMAX"
				}
			],
			"transformations": [],
			"script": "source(output(\n\t\tBranch as string,\n\t\t{Sales Type} as string,\n\t\t{Enquiry No} as string,\n\t\t{Customer Title} as string,\n\t\t{Customer Forename} as string,\n\t\t{Customer Surname} as string,\n\t\t{Company Name} as string,\n\t\tEmail as string,\n\t\t{Home Phone} as string,\n\t\t{Mobile Phone} as string,\n\t\t{Work Phone} as string,\n\t\tPostcode as string,\n\t\t{Enquiry Created} as string,\n\t\t{Enquiry Type} as string,\n\t\t{Sales Executive} as string,\n\t\t{Business Manager} as string,\n\t\t{N/U} as string,\n\t\t{Vehicle Type} as string,\n\t\tMake as string,\n\t\tRange as string,\n\t\tModel as string,\n\t\tDerivative as string,\n\t\t{Registration No} as string,\n\t\t{Registration Date} as string,\n\t\t{Stock No} as string,\n\t\t{Group Date in Stock} as string,\n\t\t{Branch Date in Stock} as string,\n\t\t{First Order Date} as string,\n\t\t{Enquiry Status} as string,\n\t\t{Invoiced Date} as string,\n\t\t{Expected Delivery Date} as string,\n\t\t{Delivery Date} as string,\n\t\t{Delivery Category} as string,\n\t\t{Metal Only} as string,\n\t\t{OTR Price exc Ins} as string,\n\t\t{Total Goods & Services inc Ins} as string,\n\t\tFinanced as string,\n\t\t{Finance Provider} as string,\n\t\t{Fin Type} as string,\n\t\t{Finance Scheme} as string,\n\t\t{Loan Term} as string,\n\t\tAPR as string,\n\t\t{Flat Rate} as string,\n\t\t{Finance Balance} as string,\n\t\t{Volume Bonus} as string,\n\t\tCommission as string,\n\t\t{DOC Fee} as string,\n\t\t{Finance Subsidy} as string,\n\t\t{Total Fin Margin} as string,\n\t\tGAP as string,\n\t\t{GAP Product} as string,\n\t\tWar as string,\n\t\t{War Product} as string,\n\t\tExt as string,\n\t\t{Ext Product} as string,\n\t\tPaint as string,\n\t\t{Paint Product} as string,\n\t\t{Total Ins Margin} as string,\n\t\t{Total F & I Margin} as string,\n\t\t{Volume Bonus Central} as string,\n\t\t{DOC Fee Central} as string,\n\t\t{Total Central Income} as string,\n\t\t{Days in Stock} as string,\n\t\t{Last Advertised Price} as string,\n\t\t{Model Analysis Code} as string,\n\t\tSIV as string,\n\t\t{Stock No66} as string,\n\t\t{Chassis No} as string,\n\t\t{Engine Size} as string,\n\t\t{Body Style} as string,\n\t\tMileage as string,\n\t\t{Fuel Type} as string,\n\t\tTransmission as string,\n\t\tColour as string,\n\t\t{Trim Type} as string,\n\t\t{Number of Doors} as string,\n\t\t{Gross Profit} as string,\n\t\t{Reconditioning Cost} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> PeterVardyEnquiryMAX\nPeterVardyEnquiryMAX sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tClientID as integer,\n\t\tDealershipID as string,\n\t\tSalesType as string,\n\t\tEnquiryNo as integer,\n\t\tCustomerTitle as string,\n\t\tCustomerForename as string,\n\t\tCustomerSurname as string,\n\t\tCompanyName as string,\n\t\tEmail as string,\n\t\tHomePhone as string,\n\t\tMobilePhone as string,\n\t\tWorkPhone as string,\n\t\tPostcode as string,\n\t\tEnquiryCreatedDate as date,\n\t\tEnquiryType as string,\n\t\tSalesExecutive as string,\n\t\tBusinessManager as string,\n\t\tNewOrUsed as string,\n\t\tVehicleType as string,\n\t\tMake as string,\n\t\tRange as string,\n\t\tModel as string,\n\t\tDerivative as string,\n\t\tRegistrationNo as string,\n\t\tRegistrationDate as date,\n\t\tStockNo as string,\n\t\tGroupDateInStock as date,\n\t\tBranchDateInStock as date,\n\t\tFirstOrderDate as date,\n\t\tEnquiryStatus as string,\n\t\tInvoicedDate as date,\n\t\tExpectedDeliveryDate as date,\n\t\tDeliveryDate as date,\n\t\tDeliveryCategory as string,\n\t\tMetalOnly as double,\n\t\tOTRPriceExcIns as double,\n\t\tTotalGoodsAndServicesIncIns as double,\n\t\tFinanced as string,\n\t\tFinanceProvider as string,\n\t\tFinanceType as string,\n\t\tFinanceScheme as string,\n\t\tLoanTerm as integer,\n\t\tAPR as double,\n\t\tFlatRate as string,\n\t\tFinanceBalance as double,\n\t\tVolumeBonus as double,\n\t\tCommission as double,\n\t\tDocFee as double,\n\t\tFinanceSubsidy as double,\n\t\tTotalFinanceMargin as double,\n\t\tGAP as double,\n\t\tGapProduct as string,\n\t\tWarranty as double,\n\t\tWarrantyProduct as string,\n\t\tExtras as double,\n\t\tExtrasProduct as string,\n\t\tPaint as double,\n\t\tPaintProduct as string,\n\t\tTotalInsMargin as double,\n\t\tTotalFandIMargin as double,\n\t\tVolumeBonusCentral as double,\n\t\tDOCFeeCentral as double,\n\t\tTotalCentralIncome as double,\n\t\tDaysInStock as integer,\n\t\tLastAdvertisedPrice as double,\n\t\tModelAnalysisCode as string,\n\t\tSIV as double,\n\t\tStockNo2 as string,\n\t\tChassisNo as string,\n\t\tEngineSize as string,\n\t\tBodyStyle as string,\n\t\tMileage as integer,\n\t\tFuelType as string,\n\t\tTransmission as string,\n\t\tColour as string,\n\t\tTrimType as string,\n\t\tNumberOfDoors as integer,\n\t\tGrossProfit as double,\n\t\tReconditioningCost as double\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\ttruncate:true,\n\tformat: 'table',\n\tpreSQLs:['truncate table dbo.enquirymaxsales'],\n\tpostSQLs:['update dbo.EnquiryMAXSales set clientid = 10000 where clientid is null'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tEmail,\n\t\tPostcode,\n\t\tMake,\n\t\tRange,\n\t\tModel,\n\t\tDerivative,\n\t\tFinanced,\n\t\tTransmission,\n\t\tColour\n\t)) ~> SQLPeterVardyEnquiryMAX"
		}
	}
}