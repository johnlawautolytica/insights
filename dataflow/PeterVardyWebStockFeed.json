{
	"name": "PeterVardyWebStockFeed",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "PeterVardyWebStockFeedCSV",
						"type": "DatasetReference"
					},
					"name": "PeterVardyWebStockFeed"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SQLWebStockFeed",
						"type": "DatasetReference"
					},
					"name": "WebStockFeed"
				}
			],
			"transformations": [
				{
					"name": "SetUpsertCriteria"
				}
			],
			"script": "source(output(\n\t\tId as string,\n\t\tDealerCode as string,\n\t\tStockNumber as string,\n\t\tNewUsed as string,\n\t\tVehicleType as string,\n\t\tDemo as string,\n\t\tVatStatus as string,\n\t\tRegistrationNumber as string,\n\t\tChassisNumber as string,\n\t\tEngineNumber as string,\n\t\tCapId as string,\n\t\tFullCapCode as string,\n\t\tCapModelYear as string,\n\t\tMake as string,\n\t\tModel as string,\n\t\tDerivative as string,\n\t\tEngineSize as string,\n\t\tDoors as string,\n\t\tBodyStyle as string,\n\t\tFuelType as string,\n\t\tTransmissionType as string,\n\t\tPaintColour as string,\n\t\tSpecificPaintColour as string,\n\t\tPaintType as string,\n\t\tTrimColour as string,\n\t\tTrimType as string,\n\t\tOdometer as string,\n\t\tOdometerType as string,\n\t\tRegistrationDate as string,\n\t\tPreviousOwners as string,\n\t\tServiceHistory as string,\n\t\tApproved as string,\n\t\tWarrantyLevel as string,\n\t\tFullVehicleCheck as string,\n\t\tMultiPointInspection as string,\n\t\tBranchPurchaseDate as string,\n\t\tGroupPurchaseDate as string,\n\t\tStockStatus as string,\n\t\tVehicleStatus as string,\n\t\tAvailableDate as string,\n\t\tReadyToGo as string,\n\t\tHoStock as string,\n\t\tOriginalPurchasePrice as string,\n\t\tStockValue as string,\n\t\tReconDfa as string,\n\t\tDeliveryCost as string,\n\t\tVehicleSalePrice as string,\n\t\tDeliveryRetailSalePrice as string,\n\t\tReducedPrice as string,\n\t\tIdaAmount as string,\n\t\tTrackerNumber as string,\n\t\tStockType as string,\n\t\tWebCategory as string,\n\t\tHouseCharge as string,\n\t\tCo2 as string,\n\t\tStatusId as string,\n\t\tIsVisible as string,\n\t\tDateCreated as string,\n\t\tDateUpdated as string,\n\t\tLastUpdatedBy as string,\n\t\tSentToWeb as string,\n\t\tSeats as string,\n\t\tManufactureDate as string,\n\t\tTaxBand as string,\n\t\tAutotraderBanner as string,\n\t\tMpg as string,\n\t\tInsuranceGroup as string,\n\t\tPlusVat as string,\n\t\tFeatured as string,\n\t\tPOA as string,\n\t\tVerified as string,\n\t\tEnquiryCount as string,\n\t\tPriceLastUpdated as string,\n\t\tIsVirtual as string,\n\t\tRemoved as string,\n\t\tPriceVerified as string,\n\t\tTradePrice as string,\n\t\tDateRemoved as string,\n\t\tActualReg as string,\n\t\tRoadTaxSix as string,\n\t\tRoadTaxTwelve as string,\n\t\tCitNowVideo as string,\n\t\tVideoRemoved as string,\n\t\tCapManId as string,\n\t\tCapModId as string,\n\t\tShortModel as string,\n\t\tFinanceOption as string,\n\t\tComingSoon as string,\n\t\tQuarantine as string,\n\t\tFinanceDeposit as string,\n\t\tFinanceTerm as string,\n\t\tYouTubeVideo as string,\n\t\tNumberOfImages as string,\n\t\tImageURLS as string,\n\t\tToBeRemoved as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> PeterVardyWebStockFeed\nPeterVardyWebStockFeed alterRow(upsertIf(true())) ~> SetUpsertCriteria\nSetUpsertCriteria sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tClientID as integer,\n\t\tDealership as string,\n\t\tFeedID as integer,\n\t\tVehicleID as integer,\n\t\tStockNumber as string,\n\t\tVehicleType as string,\n\t\tRegistrationNumber as string,\n\t\tChassisNumber as string,\n\t\tEngineNumber as string,\n\t\tColour as string,\n\t\tSpecificPaintColour as string,\n\t\tFuelType as string,\n\t\tTrimColour as string,\n\t\tTrimType as string,\n\t\tRegistrationDate as timestamp,\n\t\tYear as integer,\n\t\tMileage as integer,\n\t\tMileageType as string,\n\t\tBodyStyle as string,\n\t\tDoors as integer,\n\t\tMake as string,\n\t\tModel as string,\n\t\tDerivative as string,\n\t\tRange as string,\n\t\tEngineSize as integer,\n\t\tPrice as decimal(15,2),\n\t\tTransmission as string,\n\t\tPictureRefs as string,\n\t\tServiceHistory as string,\n\t\tPreviousOwners as integer,\n\t\tApproved as string,\n\t\tWarrantyLevel as string,\n\t\tFullVehicleCheck as string,\n\t\tMultiPointInspection as string,\n\t\tBranchPurchaseDate as timestamp,\n\t\tGroupPurchaseDate as timestamp,\n\t\tStockStatus as string,\n\t\tVehicleStatus as string,\n\t\tAvailableDate as timestamp,\n\t\tReadyToGo as string,\n\t\tHeadOfficeStock as string,\n\t\tPurchasePrice as decimal(18,2),\n\t\tStockValue as decimal(18,2),\n\t\tReconditioningDFA as decimal(18,2),\n\t\tDeliveryCost as decimal(18,2),\n\t\tRetailPrice as decimal(18,2),\n\t\tDeliveryRetailPrice as decimal(18,2),\n\t\tReducedPrice as decimal(18,2),\n\t\tIDAAmount as decimal(18,2),\n\t\tTrackerNumber as string,\n\t\tCategory as string,\n\t\tHouseCharge as string,\n\t\tCO2 as string,\n\t\tStatus as string,\n\t\tIsVisible as string,\n\t\tCreatedDate as timestamp,\n\t\tUpdatedDate as timestamp,\n\t\tLastUpdatedBy as string,\n\t\tSentToWeb as string,\n\t\tSeats as string,\n\t\tTaxBand as string,\n\t\tAutotraderBanner as string,\n\t\tMilesPerGallon as string,\n\t\tInsuranceGroup as string,\n\t\tRemoved as string,\n\t\tDateRemoved as timestamp,\n\t\tActualRegistrationNumber as string,\n\t\tQuarantine as string,\n\t\tYouTubeVideo as string,\n\t\tNumberOfImages as integer,\n\t\tNewOrUsed as string,\n\t\tDemo as string,\n\t\tVATStatus as string,\n\t\tTradePrice as decimal(15,2),\n\t\tCapID as string,\n\t\tFullCapCode as string,\n\t\tVideoURL as string,\n\t\tInsertedDate as date\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:true,\n\tupsertable:true,\n\tkeys:['VehicleID'],\n\tformat: 'table',\n\tpostSQLs:['execute UpdatePeterVardyWebStockFeedAfterInsert'],\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tFeedID = Id,\n\t\tDealership = DealerCode,\n\t\tStockNumber,\n\t\tNewOrUsed = NewUsed,\n\t\tVehicleType,\n\t\tDemo,\n\t\tVATStatus = VatStatus,\n\t\tRegistrationNumber,\n\t\tChassisNumber,\n\t\tEngineNumber,\n\t\tCapID = CapId,\n\t\tFullCapCode,\n\t\tYear = CapModelYear,\n\t\tMake,\n\t\tModel,\n\t\tDerivative,\n\t\tEngineSize,\n\t\tDoors,\n\t\tBodyStyle,\n\t\tFuelType,\n\t\tTransmission = TransmissionType,\n\t\tColour = PaintColour,\n\t\tSpecificPaintColour,\n\t\tTrimColour,\n\t\tTrimType,\n\t\tMileage = Odometer,\n\t\tMileageType = OdometerType,\n\t\tRegistrationDate,\n\t\tStockStatus,\n\t\tVehicleStatus,\n\t\tAvailableDate,\n\t\tCreatedDate = DateCreated,\n\t\tUpdatedDate = DateUpdated,\n\t\tVehicleID = Id,\n\t\tSentToWeb,\n\t\tDateRemoved,\n\t\tRemoved,\n\t\tRetailPrice = VehicleSalePrice\n\t)) ~> WebStockFeed"
		}
	}
}