{
	"name": "VehicleStock",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "VehicleStockCSV",
						"type": "DatasetReference"
					},
					"name": "VehicleStockCSV"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SQLVehicleStock",
						"type": "DatasetReference"
					},
					"name": "SQLVehicleStock"
				}
			],
			"transformations": [],
			"script": "source(output(\n\t\t{Client ID} as string,\n\t\t{Dealer ID} as string,\n\t\t{Vehicle Type} as string,\n\t\t{Registration Number} as string,\n\t\t{Stock Number} as string,\n\t\t{Group Date in Stock} as date,\n\t\t{Dealership Date In Stock} as date,\n\t\tStatus as string,\n\t\t{New Or Used} as string,\n\t\tChassis as string,\n\t\t{Registration Date} as date,\n\t\tMake as string,\n\t\tModel as string,\n\t\tDerivative as string,\n\t\tTrim as string,\n\t\t{Engine Size} as string,\n\t\tBodystyle as string,\n\t\tOdometer as string,\n\t\t{Odometer Type} as string,\n\t\tFuelType as string,\n\t\tTransmission as string,\n\t\t{Generic Colour} as string,\n\t\tDoors as string,\n\t\t{Stock Value} as decimal(10,0),\n\t\tVat as string,\n\t\tSource as string,\n\t\t{Vehicle Category Code} as string,\n\t\t{Retail Price} as decimal(10,0),\n\t\t{Purchaser ID} as string,\n\t\tSupplier as string,\n\t\t{Group Purchase Date} as date,\n\t\t{Available Date} as date,\n\t\t{Progress Code} as string,\n\t\tReconditioning as decimal(10,0),\n\t\t{Transport Costs} as decimal(10,0),\n\t\t{Adjusted Stock Value} as decimal(10,0),\n\t\t{Received Date} as date,\n\t\t{Purchase Account} as string,\n\t\t{Quarantine Status} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\trowUrlColumn: 'FileName',\n\tdateFormats: ['dd/MM/yyyy'],\n\twildcardPaths:['Client Folder/*/VehicleStock-*.csv']) ~> VehicleStockCSV\nVehicleStockCSV sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinput(\n\t\tClientID as integer,\n\t\tDealershipID as string,\n\t\tType as string,\n\t\tRegistrationNo as string,\n\t\tStockNo as string,\n\t\tGroupDateInStock as date,\n\t\tDealershipDateInStock as date,\n\t\tStatus as string,\n\t\tNewOrUsed as string,\n\t\tChassis as string,\n\t\tFirstRegisteredDate as date,\n\t\tMake as string,\n\t\tModel as string,\n\t\tDerivative as string,\n\t\tTrim as string,\n\t\tEngineSize as string,\n\t\tBodystyle as string,\n\t\tMileage as integer,\n\t\tFuelType as string,\n\t\tTransmission as string,\n\t\tGenericColour as string,\n\t\tSpecificColour as string,\n\t\tDoors as integer,\n\t\tSIV as double,\n\t\tVat as string,\n\t\tSource as string,\n\t\tModelAnalysisCode as string,\n\t\tRetailPrice as double,\n\t\tPurchaser as string,\n\t\tSupplierName as string,\n\t\tPurchaseInvoiceDate as date,\n\t\tAvailableDate as date,\n\t\tProgressCode as string,\n\t\tRecon as double,\n\t\tTransportCosts as double,\n\t\tAdjustedSIV as double,\n\t\tReceivedDate as date,\n\t\tDateInGroup as date,\n\t\tPurchaseAccount as string,\n\t\tQuarantineStatus as string\n\t),\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tpreSQLs:['delete from vehiclestock where clientid <> 10000'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError',\n\tmapColumn(\n\t\tClientID = {Client ID},\n\t\tDealershipID = {Dealer ID},\n\t\tType = {Vehicle Type},\n\t\tRegistrationNo = {Registration Number},\n\t\tStockNo = {Stock Number},\n\t\tGroupDateInStock = {Group Date in Stock},\n\t\tDealershipDateInStock = {Dealership Date In Stock},\n\t\tStatus,\n\t\tNewOrUsed = {New Or Used},\n\t\tChassis,\n\t\tFirstRegisteredDate = {Registration Date},\n\t\tMake,\n\t\tModel,\n\t\tDerivative,\n\t\tTrim,\n\t\tEngineSize = {Engine Size},\n\t\tBodystyle,\n\t\tMileage = Odometer,\n\t\tFuelType,\n\t\tTransmission,\n\t\tGenericColour = {Generic Colour},\n\t\tDoors,\n\t\tSIV = {Stock Value},\n\t\tVat,\n\t\tSource,\n\t\tModelAnalysisCode = {Vehicle Category Code},\n\t\tRetailPrice = {Retail Price},\n\t\tPurchaser = {Purchaser ID},\n\t\tSupplierName = Supplier,\n\t\tPurchaseInvoiceDate = {Group Purchase Date},\n\t\tAvailableDate = {Available Date},\n\t\tProgressCode = {Progress Code},\n\t\tRecon = Reconditioning,\n\t\tTransportCosts = {Transport Costs},\n\t\tAdjustedSIV = {Adjusted Stock Value},\n\t\tReceivedDate = {Received Date},\n\t\tDateInGroup = {Group Date in Stock},\n\t\tPurchaseAccount = {Purchase Account},\n\t\tQuarantineStatus = {Quarantine Status}\n\t)) ~> SQLVehicleStock"
		}
	}
}